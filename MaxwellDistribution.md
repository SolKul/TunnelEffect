# ボルツマン因子とマクスウェル分布の関係

マセマの「統計力学 キャンパスゼミ」で統計力学を勉強中なのですが、この本にはマクスウェル分布が出てきません。ただ、少し考えるとボルツマン因子$e^{-E/kT}$からマクスウェル分布が出せました。そこで、ボルツマン因子、マクスウェル分布、統計学の正規分布、ガンマ分布の関係を整理してみます。

# 統計学

まず統計の知識を整理します。「久保川達也・現代数理統計学の基礎」を参考にしました。

## 分布関数と確率密度関数

確率変数$X$の**分布関数**を$F_X(x)$、**確率密度関数**を$f_X(x)=\frac{d}{dx}F_X(x)$と書きます。この記事では確率変数を大文字、その実現値を小文字で書くことにします。

## 変数変換

確率変数$X$を$Y=g(X)$と変換したとき、Yの確率密度関数$f_Y(y)$は

$$
f_Y(y)=\frac{d}{dy}F_Y(y)=\frac{d}{dy}P(X\in{x|g(x)\le y})
$$

から導かれます。特に、$g(\cdot)$が単調増加、あるいは単調減少関数の場合は次で与えられます。

$$
f_Y(y)=f_X(g^{-1}(y))\frac{1}{|g'(g^{-1}(y))|}
$$

## 平方変換

確率変数$X$の確率密度関数を$f_X(x)$とします。$X$の平方変換$Y=X^2$に対して、Yの確率密度関数は

$$
f_Y(y)=\left[f_X(\sqrt{y})+f_X(-\sqrt{y})\right]\frac{1}{2\sqrt{y}}
$$

で与えられます。特に、$f_X(x)$が$y$軸に関し対称なら、$f_Y(y)=f_X(\sqrt{y})/\sqrt{y}$となります。

## 正規分布

確率変数$X$が平均$\mu$、分散$\sigma^2$の正規分布に従うとき、$X\sim \mathcal{N}(\mu,\sigma^2)$と書き、$X$の確率密度関数は次のようになります。

$$
f_X(x|\mu,\sigma^2)=\frac{1}{\sqrt{2\pi\sigma^2}}\exp{
\left[
-\frac{(x-\mu)^2}{2\sigma^2}
\right]}
$$

## ガンマ分布

確率変数$X$の確率密度関数が次のように与えられるとき、$X$はガンマ分布に従うといい、$X\sim Ga(\alpha,\beta)$と書きます。

$$
f_X(x|\alpha,\beta)=\frac{1}{\Gamma(\alpha)}\frac{1}{\beta}
\left(
\frac{x}{\beta}
\right)^{\alpha-1}
e^{-x/\beta}
$$

$\Gamma(\alpha)$はガンマ関数です。また$X\sim Ga(\alpha,\beta)$の期待値は$\alpha\beta$で分散は$\alpha\beta^2$です。

確率変数が$Z\sim\mathcal{N}(0,\sigma^2)$に従うとき、$Z^2$は$Ga(\frac{1}{2},2\sigma^2)$に従います。これは平方変換で導くことができます。また、$\sigma^2=1$のとき、$Z^2\sim Ga(\frac{1}{2},2)$となりますが、これは自由度$1$のカイ二乗分布といい、$Z^2\sim \chi_1$と表します。

## 多次元確率分布

2つの確率変数の組$(X,Y)$が$(x,y)$周辺となる確率は**同時確率密度関数**$f_{X,Y}(x,y)$を用いて表します。$X$単体、$Y$単体の確率密度関数は**周辺確率密度関数**と呼ばれ次のように表します。

$$
f_X(x)=\int_{-\infty}^\infty f_{X,Y}(x,y) dy
$$

## 確率の独立性

同時確率密度関数がそれぞれの確率密度関数の積で表せるとき、**独立**であると言います。次の場合$X$と$Y$は独立です。

$$
f_{X,Y}(x,y)=f_X(x)f_Y(y)
$$

独立であるということは、$X$は$Y$がどんな値になるかに依存せずに、確率密度関数$f_X(x)$で表される分布に従うということです。

## 多変数確率変数の変数変換

確率変数$(X,Y)$を$S=g_1(X,Y)$、$T=g_2(X,Y)$と変数変換したい場合、$(X,Y)\leftrightarrow(S,T)$が1対1対応なら、$(S,T)$の同時確率密度関数はヤコビアン$J(s,t)$を用いて次のように書けます。

$$
f_{S,T}(s,t)=f_{X,Y}(x(s,t),y(s,t))|J(s,t)|
$$

## ガンマ分布に従う確率変数同士の和

独立な確率変数$X$、$Y$がそれぞれ$X\sim Ga(\alpha_1,\beta)$、$Y\sim Ga(\alpha_2,\beta)$のとき、その和$Z=X+Y$は$Ga(\alpha_1+\alpha_2,\beta)$に従います。

# ボルツマン因子とマクスウェル分布の関係

結合系の熱浴の理論、またはカノニカル・アンサンブル理論、からエネルギーの確率はボルツマン因子$e^{-E/kT}$に比例します。ここで$K$はボルツマン定数、$T$は温度です。正確には位相空間上の点$(\pmb{q},\pmb{p})$でエネルギーが$E(\pmb{q},\pmb{p})$となる確率密度$f(\pmb{q},\pmb{p})$は次のように与えられます。

$$
f(\pmb{q},\pmb{p})=\frac{e^{-E/kT}}{\int\int_{-\infty}^\infty e^{-E/kT} d\pmb{q} d\pmb{p} }
$$

注意しなくてはならないのが、これは変数が$(\pmb{q},\pmb{p})$である関数なので、$E$の確率密度を表していますが、$E$を変数にとる確率密度関数にはなっていない点です。(次に示しますが、自由粒子の場合は$E$の確率密度関数はガンマ分布となります。)

## $x$方向にしか動かない1自由粒子の場合

質量$m$の1つの粒子が$x$方向にしか動かない1次元運動をしている場合、$x$方向の運動量を$p_x$としてエネルギーは次のように表せます。

$$
E=\frac{1}{2m}p_x^2
$$

これをボルツマン因子の式に代入すれば、係数を$A$として確率密度関数は次のように表せます。

$$
f(p_x)=A\exp{\left[-\frac{p_x^2}{2mkT}\right]}
$$

係数$A$はこの確率密度関数を$p_x$で積分したときに$1$になるようにすればよく、$p_x$についての関数の形に注目すればこれは正規分布と同じ形です。したがって、$p_x$は$\mathcal{N}(0,mkT)$に従うと言えます。(ボルツマン因子の式はエネルギー$E$についての確率密度なのにここで$p_x$についての確率密度関数としてしまっているのは不正確な気がしますが無視します。)

よって、$p_x^2$はガンマ分布$Ga(\frac{1}{2},2mkT)$に従います。よってエネルギー$E=\frac{1}{2m}p_x^2$は変数変換を考えれば$Ga(\frac{1}{2},kT)$に従います。ガンマ分布$Ga(\alpha,\beta)$の期待値は$\alpha\beta$でしたので、1次元自由粒子のエネルギーの期待値$\langle E\rangle$は

$$
\langle E\rangle=\frac{1}{2}kT
$$

となります。

## 2次元1自由粒子の場合

次に$x$、$y$方向に2次元運動をしている自由粒子について考えます。エネルギーは次のように表せます。


$$
E=\frac{1}{2m}\left(p_x^2+p_y^2\right)
$$

これをボルツマン因子の式に代入すれば、係数を$A$として$(p_x,p_y)$の同時確率密度関数は次のように表せます。

$$
\begin{aligned}
f(p_x,p_y)&=A\exp{\left[-\frac{p_x^2+p_y^2}{2mkT}\right]}\\
&=\sqrt{A}\exp{\left[-\frac{p_x^2}{2mkT}\right]}\sqrt{A}\exp{\left[-\frac{p_y^2}{2mkT}\right]}
\end{aligned}
$$

同時確率密度関数が$p_x$、$p_y$の関数の積の形に書けたので、$p_x$と$p_y$は独立で、それぞれ$\mathcal{N}(0,mkT)$に従います。よって$p_x^2$と$p_y^2$は独立にガンマ分布$Ga(\frac{1}{2},2mkT)$に従います。よってガンマ分布に従う確率変数同士の和の性質から

$$
\begin{aligned}
p_x^2+p_y^2&\sim Ga(1,2mkT)\\
E=\frac{p_x^2+p_y^2}{2m}&\sim Ga(1,kT)
\end{aligned}
$$

よって2次元自由粒子のエネルギーの期待値$\langle E\rangle$は

$$
\langle E\rangle=kT
$$

となります。


ただ、「確率密度の関数が運動量の関数の積の形に表せた→独立だからそれぞれ正規分布に従う→よってエネルギーはガンマ分布に従う」(※)というのはちょっと納得できない部分もあるので、変数変換で直接エネルギーの確率密度関数を導出してみます。



確率変数$X,Y$についての多変数正規分布の確率密度関数
$$
\begin{aligned}
f_{X,Y}(x,y)&=\frac{a}{\pi}e^{-a(x^2+y^2)}\\
&=\sqrt{\frac{a}{\pi}}e^{-ax^2}
\sqrt{\frac{a}{\pi}}e^{-ay^2}\tag{a1}
\end{aligned}
$$
を考えます。

また、もし$X$,$Y$が独立に$\mathcal{N}(0,1/2a)$に従うなら、$S=X^2+Y^2$は$Ga(1,1/a)$に従うと予想されます。$Ga(1,1/a)$の確率密度関数は
$$
f_X(x|1,\frac{1}{a})=\frac{1}{\Gamma(1)}a
(ax)^{1-1}
e^{-ax}=ae^{-ax}\tag{a2}
$$
となります。

式(a1)を$S=X^2+Y^2$と変数変換したときの$S$の確率密度関数が、式(a2)に一致すれば、(※)は正しいとしてよさそうです。

そこで多変数の変数変換をします。$S=X^2+Y^2$、$T=X$とすると、$x=t$、$y=\pm\sqrt{s-t^2}$なので

$$
\begin{aligned}
J(s,t)=\frac{1}{J(x,y)}&=det^{-1}
\begin{pmatrix}
\frac{ds}{dx} & \frac{ds}{dy}\\
\frac{dt}{dx} & \frac{dt}{dy}
\end{pmatrix}\\
&=det^{-1}
\begin{pmatrix}
2x & 2y\\
1 & 0
\end{pmatrix}\\
&=\mp\frac{1}{2\sqrt{s-t^2}}
\end{aligned}
$$

ただ、$(X,Y)\leftrightarrow(S,T)$が1対1対応ではありません。多変数の変数変換の式は1対1対応でないと使えないのですが、とりあえず$y>0$の場合のみ考えると、
$$
\begin{aligned}
f_{S,T}(s,t;y>0)=f_{X,Y}(x,y)\frac{1}{2\sqrt{s-t^2}}\\
=\frac{a}{\pi}\frac{e^{-as}}{2\sqrt{s-t^2}}
\end{aligned}
$$
なので、$y>0$の場合の$S$の周辺確率密度関数は
$$
f_{S}(s;y>0)=\int_{-\sqrt{S}}^{\sqrt{S}}\frac{a}{\pi}\frac{e^{-as}}{2\sqrt{s-t^2}}dt
$$
ここで$u=t/\sqrt{s}$と変数変換すると$t:-\sqrt{S}\rightarrow\sqrt{S}$で$u:-1\rightarrow1$で、$du/ds=1/\sqrt{s}$なので、
$$
\int_{-\sqrt{S}}^{\sqrt{S}}\frac{1}{\sqrt{s-t^2}}dt=\int_{-1}^1\frac{1}{\sqrt{s}}\frac{\sqrt{s}}{\sqrt{1-u^2}}du
$$
さらに$u=\sin\theta$とすれば、$u:-1\rightarrow1$で$\theta:-\pi/2\rightarrow\pi/2$で、$du/d\theta=\cos\theta$なので、
$$
\int_{-1}^1\frac{1}{\sqrt{1-u^2}}du=\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}}\frac{\cos\theta}{\sqrt{1-\sin^2{\theta}}}d\theta=\pi
$$
となります。よって、
$$
f_S(s;y>0)=\frac{a}{2}e^{-as}
$$
となります。$y<0$の場合も同じ式が出てくるので、単純この式を2倍すればいいとすれば、
$$
f_S(s)=ae^{-as}
$$
となります。よって式(a2)と一致しました。よって、「確率密度の関数が運動量の関数の積の形にかけた→独立だからそれぞれ正規分布に従う→よってエネルギーはガンマ分布に従う」としてよさそうです。

## 3次元1自由粒子の場合

次に$x$、$y$、$z$方向の3次元運動をしている自由粒子について考えます。これまでと同様、$p_x$、$p_y$と$p_z$は独立で、それぞれ$\mathcal{N}(0,mkT)$に従います。よって$p_x^2$、$p_y^2$と$p_z^2$は独立にガンマ分布$Ga(\frac{1}{2},2mkT)$に従います。よってガンマ分布に従う確率変数同士の和の性質から

$$
\begin{aligned}
p_x^2+p_y^2+p_z^2&\sim Ga(\frac{3}{2},2mkT)\\
E=\frac{p_x^2+p_y^2+p_z^2}{2m}&\sim Ga(\frac{3}{2},kT)
\end{aligned}
$$

よって3次元自由粒子のエネルギーの期待値$\langle E\rangle$は

$$
\langle E\rangle=\frac{3}{2}kT
$$

となります。

## マクスウェル分布

いよいよマクスウェル分布を導出します。3次元運動をしている自由粒子の速さ$v(v\ge0)$は、$x$方向の速度が$v_x=p_x/m$と表せられることを使って、次のように表せます。

$$
\begin{aligned}
v&=\sqrt{v_x^2+v_y^2+v_z^2}\\
&=\frac{1}{m}\sqrt{p_x^2+p_y^2+p_z^2}
\end{aligned}
$$
ここで$p=\sqrt{p_x^2+p_y^2+p_z^2}$と定義すると$u=p^2$はガンマ分布$Ga(3/2,2mkT)$に従います。変数変換によって、$p=\sqrt{u}$の確率密度関数を導出してみます。$du/dp=2p$を使い、変数変換の公式を使うと、$p$の確率密度関数は次のようになります。


$$
\begin{aligned}
f_p(p)&=2pf_u(u)\\
&=\frac{2p}{\Gamma(\frac{3}{2})}\frac{1}{2mkT}
\left(\frac{u}{2mkT}\right)^{3/2-1}
\exp{\left(
\frac{-u}{2mkT}
\right)}\\
&=\sqrt{\frac{2}{\pi}}\frac{p^2}{(mkT)^{3/2}}
\exp{\left(
\frac{-p^2}{2mkT}
\right)}
\end{aligned}
$$

さらに$v=p/m$で、$dp/dv=m$を使い変数変換の公式を使うと、速さ$v$の確率密度関数は

$$
\begin{aligned}
f_v(v)&=mf_p(p)\\
&=\sqrt{\frac{2}{\pi}}
\left(
\frac{m}{kT}
\right)^{3/2}
v^2
\exp{\left(
\frac{-mv^2}{2kT}
\right)}\\
&=4\pi v^2
\left(
\frac{m}{2\pi kT}
\right)^{3/2}
\exp{\left(
\frac{-mv^2}{2kT}
\right)}
\end{aligned}
$$

となり、↓のWikipediaに乗っているのと同じマクスウェル分布が導出できました。
[マクスウェル分布 -Wikipedia-](https://ja.wikipedia.org/wiki/%E3%83%9E%E3%82%AF%E3%82%B9%E3%82%A6%E3%82%A7%E3%83%AB%E5%88%86%E5%B8%83)

## $N$個の自由粒子の場合
質量$m$の$N$個の粒子が3次元運動しているとき、エネルギー$E$は次のようになります。

$$
E=\frac{1}{2m}\left(p_1^2+p_2^2+\cdots+p_{3N}^2\right)
$$

これまでと同様に、$p_1,p_2,\cdots$は独立で、それぞれ$\mathcal{N}(0,mkT)$に従います。よって$p_1^2,p_2^2,\cdots$は独立にガンマ分布$Ga(\frac{1}{2},2mkT)$に従います。よってガンマ分布に従う確率変数同士の和の性質から

$$
\begin{aligned}
p_1^2+p_2+\cdots +p_{3N}^2&\sim Ga(\frac{3N}{2},2mkT)\\
E=\frac{p_1^2+p_2+\cdots +p_{3N}}{2m}&\sim Ga(\frac{3N}{2},kT)
\end{aligned}
$$

よって$N$個の自由粒子の総エネルギーの期待値$\langle E\rangle$は

$$
\langle E\rangle=\frac{3}{2}NkT
$$

となります。

# まとめ
今まで出てきた物理量の分布を表にまとめます。

|  物理量  |  分布  | 期待値 |
| ---- | ---- | --- |
|  自由粒子の$x$方向の速度$v_x$  |  $\mathcal{N}(0,kT/m)$  | $0$ |
|  自由粒子の$x$方向の運動量$p_x$  |  $\mathcal{N}(0,mkT)$  | $0$ |
|  自由粒子の$p_x^2$ |  $Ga(\frac{1}{2},2mkT)$  | $mkT$ |
|  3次元1自由粒子のエネルギー$E$ |  $Ga(\frac{3}{2},kT)$  | $\frac{3}{2}kT$ |
|  自由粒子の速さ$v=\sqrt{v_x^2+v_y^2+v_z^2}$  |  マクスウェル分布  | $\sqrt{\frac{8kT}{\pi m}}$
|  $N$個の自由粒子の総エネルギー$E$  |  $Ga(\frac{3N}{2},kT)$  | $\frac{3}{2}NkT$

# 感想

ボルツマン因子$e^{-E/kT}$からマクスウェル分布が導出できました。

ただ、ボルツマン因子は熱浴の議論やカノニカルアンサンブル理論から導出されるもので、指数のエネルギー(ハミルトニアン)$E$の形に依りません。なので外力がかかったりして$E$の形が変わっても使えます。

一方、マクスウェル分布は自由粒子の仮定のもと導出したので、自由粒子でない場合はマクスウェル分布はそのままでは使えないです(ように思えます)。ボルツマン因子の方がマクスウェル分布より汎用的であるといえそうです。